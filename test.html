<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Labyrinthe d'Alice (qui tourne)</title>
<style>
  :root{
    --size: 720px;         /* taille du canevas (modifiable) */
    --bg: #0f1724;
    --maze-stroke: #e6f0ff;
    --accent: #ff69b4;
    --speed: 12s;          /* durée d'une rotation complète */
  }
  html,body{height:100%;margin:0;background:var(--bg);font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;}
  .wrap{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
    box-sizing:border-box;
    gap:20px;
    flex-direction:column;
  }

  .stage{
    width:clamp(320px, 70vmin, var(--size));
    aspect-ratio:1/1;
    position:relative;
    border-radius:18px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    box-shadow: 0 8px 30px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    padding:12px;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  /* zone SVG centrée */
  svg{width:100%;height:100%;display:block;overflow:visible}

  /* animation de rotation du groupe maze */
  .maze {
    transform-origin: 50% 50%;
    animation: spin linear infinite;
    animation-duration: var(--spin-duration, var(--speed));
  }
  /* Alice contre-rotates to stay upright */
  .alice {
    transform-origin: 50% 50%;
    animation: counterspin linear infinite;
    animation-duration: var(--spin-duration, var(--speed));
  }

  @keyframes spin {
    from{transform: rotate(0deg)}
    to{transform: rotate(360deg)}
  }
  @keyframes counterspin {
    from{transform: rotate(0deg)}
    to{transform: rotate(-360deg)}
  }

  /* UI controls */
  .controls{
    width:clamp(320px, 70vmin, var(--size));
    display:flex;
    gap:8px;
    align-items:center;
    justify-content:center;
  }
  .controls button, .controls input[type="range"]{
    -webkit-appearance:none;
    border:0;
    padding:10px 12px;
    border-radius:10px;
    background:rgba(255,255,255,0.04);
    color:white;
    cursor:pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.5);
    font-size:14px;
  }
  .controls button:hover{background:rgba(255,255,255,0.06)}
  .speed-label{color:#cbd5e1;font-size:13px;min-width:46px;text-align:center}

  /* small helper - central dot */
  .center-dot{fill:var(--accent); filter:drop-shadow(0 3px 6px rgba(0,0,0,0.6));}
  
  /* accessibility */
  .visually-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}
</style>
</head>
<body>
<div class="wrap">
  <div class="stage" role="img" aria-label="Labyrinthe circulaire tournant avec Alice">
    <!-- SVG: labyrinthe (concentrique avec portes/gaps) + personnage Alice -->
    <svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg" aria-hidden="false" role="presentation">
      <!-- background circle -->
      <defs>
        <filter id="soft" x="-50%" y="-50%" width="200%" height="200%">
          <feGaussianBlur stdDeviation="1.2" result="b"/>
          <feBlend in="SourceGraphic" in2="b"/>
        </filter>
      </defs>

      <rect width="500" height="500" fill="transparent"/>

      <!-- groupe qui tournera -->
      <g class="maze" id="mazeGroup">
        <!-- base : cercles concentriques simulant murs; gaps réalisés par arcs -->
        <!-- ring generator - handcrafted arcs for visual labyrinth -->
        <!-- outer ring -->
        <path d="M 50 250
                 A 200 200 0 1 1 450 250
                 A 200 200 0 1 1 50 250 Z"
              fill="none" stroke="rgba(255,255,255,0.02)" stroke-width="36" stroke-linecap="round"/>
        <!-- ring 1 with gaps -->
        <path d="M 110 250 A 140 140 0 1 0 390 250" fill="none" stroke="var(--maze-stroke)" stroke-width="18" stroke-linecap="round"/>
        <path d="M 390 250 A 140 140 0 1 0 110 250" fill="none" stroke="var(--maze-stroke)" stroke-width="18" stroke-linecap="round" stroke-dasharray="2 18" opacity="0.9"/>

        <!-- ring 2 -->
        <path d="M 150 250 A 100 100 0 1 1 350 250" fill="none" stroke="var(--maze-stroke)" stroke-width="14" stroke-linecap="round"/>
        <!-- make gaps by overlaying background-colored arcs to simulate openings -->
        <path d="M 150 250 A 100 100 0 0 1 260 130" stroke="rgba(15,23,36,1)" stroke-width="14" fill="none" stroke-linecap="round"/>
        
        <!-- ring 3 inner -->
        <path d="M 200 250 A 50 50 0 1 0 300 250" fill="none" stroke="var(--maze-stroke)" stroke-width="10" stroke-linecap="round"/>
        <path d="M 240 250 A 50 50 0 1 0 260 245" stroke="rgba(15,23,36,1)" stroke-width="10" fill="none" stroke-linecap="round"/>

        <!-- decorative spokes to give labyrinth feeling -->
        <g stroke="rgba(230,240,255,0.06)" stroke-width="6" stroke-linecap="round">
          <path d="M250 50 L250 150"/>
          <path d="M250 350 L250 450"/>
          <path d="M50 250 L150 250"/>
          <path d="M350 250 L450 250"/>
          <path d="M110 110 L170 170"/>
          <path d="M330 330 L390 390"/>
        </g>

        <!-- center plate -->
        <circle cx="250" cy="250" r="36" fill="rgba(255,255,255,0.02)" stroke="rgba(255,255,255,0.06)" stroke-width="2"/>
      </g>

      <!-- Alice group (placed centered). This group will do a counter-rotation so she stays upright -->
      <g class="alice" id="aliceGroup" transform="translate(250,210)">
        <!-- simple stylized Alice - head, hair, dress -->
        <!-- hair -->
        <path d="M -22 -12 C -30 -26, -4 -42, 10 -36 C 24 -30, 34 -12, 22 -2 C 10 6, -2 6, -14 2 C -22 -1, -20 -6, -22 -12 Z"
              fill="#1f2a44" opacity="0.95"/>
        <!-- face -->
        <circle cx="0" cy="0" r="10" fill="#ffe6d6" stroke="rgba(0,0,0,0.06)" stroke-width="0.6"/>
        <!-- eyes -->
        <circle cx="-3" cy="-1" r="1.2" fill="#2b2b2b"/>
        <circle cx="3" cy="-1" r="1.2" fill="#2b2b2b"/>
        <!-- dress -->
        <path d="M -16 12 C -8 28, 8 28, 16 12 C 10 30, -10 30, -16 12 Z" fill="url(#dressGradient)"/>
        <!-- small legs -->
        <g transform="translate(-6,34)">
          <rect x="0" y="0" width="4" height="10" rx="2" fill="#1f2a44"/>
        </g>
        <g transform="translate(6,34)">
          <rect x="0" y="0" width="4" height="10" rx="2" fill="#1f2a44"/>
        </g>
        <!-- add subtle shadow -->
        <ellipse cx="0" cy="48" rx="18" ry="6" fill="rgba(0,0,0,0.25)" opacity="0.35"/>
      </g>

      <defs>
        <linearGradient id="dressGradient" x1="0" x2="1">
          <stop offset="0" stop-color="#ffd6ec"/>
          <stop offset="1" stop-color="#ff69b4"/>
        </linearGradient>
      </defs>
    </svg>
  </div>

  <div class="controls" aria-hidden="false">
    <button id="toggleBtn" aria-pressed="false" title="Pause / Reprendre">Pause</button>
    <label class="speed-label" for="speedRange">Vitesse</label>
    <input id="speedRange" type="range" min="4" max="30" step="0.5" value="12" aria-label="Réglage de la vitesse (secondes par tour)">
    <div class="speed-label" id="speedValue">12s</div>
  </div>

  <div style="color:#93c5fd;font-size:13px;opacity:0.9;max-width:760px;text-align:center">
    Astuce : modifie la variable <code>--size</code> ou l'attribut <code>viewBox</code> si tu veux adapter la taille. Héberge le fichier et intègre-le dans Genially via un iframe.
  </div>
</div>

<script>
  // Contrôles et logique
  (function(){
    const maze = document.getElementById('mazeGroup');
    const alice = document.getElementById('aliceGroup');
    const toggleBtn = document.getElementById('toggleBtn');
    const speedRange = document.getElementById('speedRange');
    const speedValue = document.getElementById('speedValue');

    // set initial animation duration from CSS var
    function setDuration(sec){
      const dur = sec + 's';
      maze.style.setProperty('--spin-duration', dur);
      alice.style.setProperty('--spin-duration', dur);
      speedValue.textContent = sec + 's';
    }

    setDuration(speedRange.value);

    // Pause / Play toggle
    let playing = true;
    toggleBtn.addEventListener('click', () => {
      playing = !playing;
      if(!playing){
        maze.style.animationPlayState = 'paused';
        alice.style.animationPlayState = 'paused';
        toggleBtn.textContent = 'Reprendre';
        toggleBtn.setAttribute('aria-pressed', 'true');
      } else {
        maze.style.animationPlayState = 'running';
        alice.style.animationPlayState = 'running';
        toggleBtn.textContent = 'Pause';
        toggleBtn.setAttribute('aria-pressed', 'false');
      }
    });

    // speed control
    speedRange.addEventListener('input', (e) => {
      const v = e.target.value;
      setDuration(v);
    });

    // optional: click on stage to invert rotation direction
    let invert = false;
    document.querySelector('.stage').addEventListener('dblclick', () => {
      invert = !invert;
      if(invert){
        maze.style.animationDirection = 'reverse';
        alice.style.animationDirection = 'reverse';
      } else {
        maze.style.animationDirection = 'normal';
        alice.style.animationDirection = 'normal';
      }
    });

    // Accessibility: keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if(e.key === ' '){ // espace -> toggle
        e.preventDefault();
        toggleBtn.click();
      } else if(e.key === 'ArrowUp'){
        speedRange.value = Math.max(parseFloat(speedRange.min), parseFloat(speedRange.value)-0.5);
        speedRange.dispatchEvent(new Event('input'));
      } else if(e.key === 'ArrowDown'){
        speedRange.value = Math.min(parseFloat(speedRange.max), parseFloat(speedRange.value)+0.5);
        speedRange.dispatchEvent(new Event('input'));
      }
    });

    // Ensure animations start with the correct playState
    maze.style.animationPlayState = 'running';
    alice.style.animationPlayState = 'running';
  })();
</script>
</body>
</html>
